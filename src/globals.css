@import "tailwindcss";
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;500;700&family=JetBrains+Mono:wght@400;500&family=Space+Grotesk:wght@500;700&display=swap');

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  /* Maputnik Design Tokens */
  --color-panel-bg: var(--color-panel-bg);
  --color-panel-surface: var(--color-panel-surface);
  --color-panel-border: var(--color-panel-border);
  --color-panel-text: var(--color-panel-text);
  --color-panel-muted: var(--color-panel-muted);
  --color-panel-hover: var(--color-panel-hover);
  --color-panel-active: var(--color-panel-active);
  --color-panel-accent: var(--color-panel-accent);
  --color-panel-muted-2: var(--color-panel-muted-2);

  --spacing-maputnik-1: 2px;
  --spacing-maputnik-2: 4px;
  --spacing-maputnik-3: 8px;
  --spacing-maputnik-4: 16px;
  --spacing-maputnik-5: 24px;

  --font-size-maputnik-1: 18px;
  --font-size-maputnik-2: 16px;
  --font-size-maputnik-3: 14px;
  --font-size-maputnik-4: 13px;
  --font-size-maputnik-5: 12px;
  --font-size-maputnik-6: 11px;

  --width-layout-list: 240px;
  --width-layout-editor: 420px;

  --animate-accordion-down: accordion-down 0.2s ease-out;
  --animate-accordion-up: accordion-up 0.2s ease-out;

  @keyframes accordion-down {
    from {
      height: 0;
    }
    to {
      height: var(--radix-accordion-content-height);
    }
  }

  @keyframes accordion-up {
    from {
      height: var(--radix-accordion-content-height);
    }
    to {
      height: 0;
    }
  }
}

:root {
  /* --- Primitives --- */
  /* Brand: Green */
  --brand-base: 118.2 37.7% 51%;
  
  /* Neutral Scale (Slate) */
  --slate-50: 210 40% 98%;
  --slate-100: 210 40% 96.1%;
  --slate-200: 214.3 31.8% 91.4%;
  --slate-300: 212.7 26.8% 83.9%;
  --slate-400: 215.4 16.3% 46.9%;
  --slate-500: 215.3 19.3% 34.5%;
  --slate-600: 215.3 25% 26.7%;
  --slate-700: 217.2 32.6% 17.5%;
  --slate-800: 215.3 25% 15.1%;
  --slate-900: 222.2 47.4% 11.2%;
  --slate-950: 222.2 84% 4.9%;

  /* --- Semantics: Light Mode --- */
  /* Note: V4 defines colors in hsl() format usually, but here we define channels for hsl(var(...)) usage */
  --background: hsl(var(--slate-50));
  --foreground: hsl(var(--slate-900));

  --primary: hsl(var(--brand-base));
  --primary-foreground: hsl(var(--slate-50));

  --secondary: hsl(var(--slate-100));
  --secondary-foreground: hsl(var(--slate-900));

  --muted: hsl(var(--slate-100));
  --muted-foreground: hsl(var(--slate-400));

  --accent: hsl(var(--brand-base));
  --accent-foreground: hsl(var(--slate-900));

  --destructive: hsl(346.8 77.2% 49.8%);
  --destructive-foreground: hsl(var(--slate-50));

  --border: hsl(var(--slate-200));
  --input: hsl(var(--slate-200));
  --ring: hsl(var(--brand-base));

  --card: hsl(0 0% 100%);
  --card-foreground: hsl(var(--slate-900));
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(var(--slate-900));

  --radius: 0.5rem;

  --sidebar: hsl(0 0% 98%);
  --sidebar-foreground: hsl(240 5.3% 26.1%);
  --sidebar-primary: hsl(240 5.9% 10%);
  --sidebar-primary-foreground: hsl(0 0% 98%);
  --sidebar-accent: hsl(240 4.8% 95.9%);
  --sidebar-accent-foreground: hsl(240 5.9% 10%);
  --sidebar-border: hsl(220 13% 91%);
  --sidebar-ring: hsl(var(--brand-base));
  
  /* --- Components: Maputnik Specific --- */
  --color-panel-bg: var(--background);
  --color-panel-surface: var(--card);
  --color-panel-border: var(--border);
  --color-panel-text: var(--foreground);
  --color-panel-muted: var(--muted-foreground);
  --color-panel-muted-2: var(--muted);
  --color-panel-hover: var(--accent);
  --color-panel-active: hsl(var(--brand-base) / 0.1);
  --color-panel-accent: var(--primary);
}

.dark {
  /* Slate 950 */
  --background: hsl(var(--slate-950));
  --foreground: hsl(var(--slate-50));

  --primary: hsl(var(--brand-base));
  --primary-foreground: hsl(222.2 47.4% 11.2%);

  --secondary: hsl(var(--slate-800));
  --secondary-foreground: hsl(var(--slate-50));

  --muted: hsl(var(--slate-800));
  --muted-foreground: hsl(215 20.2% 65.1%);

  --accent: hsl(var(--brand-base));
  --accent-foreground: hsl(var(--slate-50));

  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(var(--slate-50));

  --border: hsl(var(--slate-800));
  --input: hsl(var(--slate-800));
  --ring: hsl(var(--brand-base));

  --card: hsl(var(--slate-950));
  --card-foreground: hsl(var(--slate-50));
  --popover: hsl(var(--slate-950));
  --popover-foreground: hsl(var(--slate-50));

  --sidebar: hsl(240 5.9% 10%);
  --sidebar-foreground: hsl(240 4.8% 95.9%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 3.7% 15.9%);
  --sidebar-accent-foreground: hsl(240 4.8% 95.9%);
  --sidebar-border: hsl(240 3.7% 15.9%);
  --sidebar-ring: hsl(var(--brand-base));

  --color-panel-bg: var(--background);
  --color-panel-surface: var(--card);
  --color-panel-border: var(--border);
  --color-panel-text: var(--foreground);
  --color-panel-muted: var(--muted-foreground);
  --color-panel-muted-2: var(--muted);
  --color-panel-hover: var(--accent);
  --color-panel-active: hsl(var(--brand-base) / 0.1);
  --color-panel-accent: var(--primary);
}

@layer base {
  body {
    @apply bg-background text-foreground;
    font-family: 'DM Sans', sans-serif;
    line-height: 1;
    overflow: hidden;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Space Grotesk', sans-serif;
  }

  @font-face {
    font-family: 'Roboto';
    src: url('./fonts/Roboto-Medium.ttf') format('truetype');
    font-weight: bold;
    font-style: normal;
    font-display: swap;
  }

  * {
    @apply border-border outline-ring/50;
    box-sizing: inherit;
  }

  html {
    background-color: rgb(28, 31, 36);
    color: #FFFFFF;
    font-size: 12px;
    box-sizing: border-box;
    height: 100vh;
  }

  body {
    @apply bg-background text-foreground;
    line-height: 1;
    overflow: hidden;
  }

  p {
    font-size: 11px;
    margin-top: 6px;
    margin-bottom: 6px;
    color: #94A3B8;
    line-height: 1.3;
  }

  h1 {
    font-size: 16px;
    margin-bottom: 10px;
    font-weight: bold;
  }

  h2 {
    font-size: 14px;
    margin-bottom: 10px;
    font-weight: bold;
  }

  h3 {
    font-size: 13px;
    margin-bottom: 10px;
    font-weight: bold;
  }

  h4 {
    font-size: 12px;
    margin-bottom: 10px;
  }

  ol, ul {
    list-style: none;
  }

  blockquote, q {
    quotes: none;
  }

  blockquote:before, blockquote:after,
  q:before, q:after {
    content: '';
    content: none;
  }

  table {
    border-collapse: collapse;
    border-spacing: 0;
  }

  a {
    color: #2563EB;
  }

  *:not(select) {
    &::-webkit-scrollbar {
      background-color: #F8FAFC;
      width: 8px;
      height: 8px;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 6px;
      box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.2);
      background-color: #CBD5E1;
      padding-left: 2px;
      padding-right: 2px;

      &:hover {
        background-color: #64748B;
      }
    }

    scrollbar-width: thin;
    scrollbar-color: #CBD5E1 #F8FAFC;
  }
}

@layer components {
  /* Legacy Component Compatibility Classes */
  .maputnik-input,
  .maputnik-string,
  .maputnik-number,
  .maputnik-select,
  .maputnik-checkbox-wrapper {
    @apply h-[28px] w-full block border border-panel-border rounded-md bg-panel-surface text-panel-text text-xs px-2 transition-all duration-160;
  }
  .maputnik-input:focus,
  .maputnik-string:focus,
  .maputnik-number:focus,
  .maputnik-select:focus,
  .maputnik-checkbox-wrapper:focus {
    @apply outline-none border-panel-accent shadow-[0_0_0_2px_rgba(22,119,255,0.12)];
  }

  .maputnik-string--multi { @apply h-[78px] resize-y; }
  .maputnik-string--disabled { @apply bg-transparent border-none; }

  .maputnik-select {
    @apply appearance-none bg-[right_2px_center] bg-no-repeat pr-[20px];
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24'%3E%3Cpath fill='%238e8e8e' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
  }

  .maputnik-button {
    @apply inline-block cursor-pointer bg-panel-surface text-panel-text text-xs p-1.5 border border-panel-border rounded-full shadow-sm select-none no-underline transition-colors;
  }
  .maputnik-button:hover:not(:disabled) {
    @apply bg-panel-hover border-panel-accent;
  }
  .maputnik-button:disabled {
    @apply bg-panel-hover text-panel-muted-2 cursor-not-allowed opacity-50;
  }
  .maputnik-button-selected {
    @apply bg-panel-active border-panel-accent;
  }

  .maputnik-input-block {
    @apply m-3 flex flex-wrap items-center;
  }
  .maputnik-input-block-label {
    @apply text-panel-muted font-medium select-none w-[70px] flex-[0_0_70px] text-xs leading-relaxed self-center;
  }
  .maputnik-input-block-action {
    @apply text-panel-muted select-none w-[64px] flex-[0_0_64px] text-xs text-right leading-relaxed self-center;
  }
  .maputnik-input-block-content {
    @apply w-auto flex-1 min-w-0;
  }

  .maputnik-input-block--wide .maputnik-input-block-content { @apply block w-auto flex-1; }
  .maputnik-input-block--wide .maputnik-input-block-label { @apply w-auto flex-1; }

  .maputnik-input-block--inline { @apply flex items-center gap-2; }
  .maputnik-input-block--inline .maputnik-input-block-label { @apply w-auto min-w-[80px] shrink-0 mb-0; }

  .maputnik-checkbox-wrapper { @apply text-center p-0 cursor-pointer max-w-[24px] relative; }

  /* Modal Legacy Classes */
  .maputnik-modal-content {
     @apply p-3 flex flex-col;
  }

  .maputnik-export-modal .maputnik-input-block-label { @apply w-1/2 self-center; }
  .maputnik-export-modal .maputnik-input-block-action { @apply w-0; }

  .maputnik-add-layer-button {
     @apply mt-3 mb-3 text-right float-right inline-block p-3 text-sm;
  }

  /* Map Legacy Styles */
  .maputnik-map__container {
    @apply bg-panel-bg flex flex-1 min-w-0;
    width: var(--width-layout-map);
  }
  .maputnik-map__container--error { @apply items-center justify-center; }
  .maputnik-map__map { @apply w-full h-full; }

  /* Geocoder Override */
  .maplibregl-ctrl-geocoder {
    @apply !bg-panel-surface !text-panel-text !shadow-sm !rounded-full !border !border-panel-border !max-w-[240px];
  }
  .maplibregl-ctrl-geocoder--input {
    @apply !text-panel-text !font-sans;
  }
  .maplibregl-ctrl-geocoder--input::placeholder {
    @apply !text-panel-muted;
  }
  .maplibregl-ctrl-geocoder--icon-search {
    fill: var(--color-panel-accent) !important;
  }
}

@layer utilities {
  .clearfix::after {
    content: "";
    @apply table clear-both;
  }

  .hide {
    display: none !important;
  }

  .w-layout-list {
    width: var(--width-layout-list);
  }
  .w-layout-editor {
    width: var(--width-layout-editor);
  }
}
